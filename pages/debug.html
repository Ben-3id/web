<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - موقع إسلامي</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .debug-section {
            background: white;
            padding: 2rem;
            margin: 1rem 0;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .debug-item {
            margin: 1rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #1e3c72;
        }
        .status-success { color: #28a745; }
        .status-error { color: #dc3545; }
        .status-warning { color: #ffc107; }
        .test-button {
            background: #1e3c72;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 0.5rem;
        }
        .test-button:hover {
            background: #2a5298;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <h1>مراقى الوعى</h1>
                <p>وقف لله</p>
            </div>
            <nav class="nav">
                <ul>
                    <li><a href="../home.html">الرئيسية</a></li>
                    <li><a href="debug.html">Debug</a></li>
                    <li><a href="contact.html">اتصل بنا</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="debug-section">
                <h1>🔧 Debug Page</h1>
                <p>اختبار وظائف الموقع وتشخيص المشاكل</p>
            </div>

            <div class="debug-section">
                <h2>📊 حالة البيانات</h2>
                <div id="dataStatus" class="debug-item">
                    <div>جاري فحص البيانات...</div>
                </div>
            </div>

            <div class="debug-section">
                <h2>🧭 اختبار التنقل</h2>
                <div class="debug-item">
                    <h3>روابط التنقل:</h3>
                    <button class="test-button" onclick="testNavigation('home')">اختبار الصفحة الرئيسية</button>
                    <button class="test-button" onclick="testNavigation('section')">اختبار صفحة القسم</button>
                    <button class="test-button" onclick="testNavigation('topic')">اختبار صفحة الموضوع</button>
                    <button class="test-button" onclick="testNavigation('contact')">اختبار صفحة الاتصال</button>
                </div>
            </div>

            <div class="debug-section">
                <h2>🔍 اختبار الوظائف</h2>
                <div class="debug-item">
                    <h3>وظائف الموقع:</h3>
                    <button class="test-button" onclick="testWebsiteFunctions()">اختبار وظائف الموقع</button>
                    <button class="test-button" onclick="testDataAccess()">اختبار الوصول للبيانات</button>
                    <button class="test-button" onclick="testSearch()">اختبار البحث</button>
                </div>
            </div>

            <div class="debug-section">
                <h2>📱 اختبار الاستجابة</h2>
                <div class="debug-item">
                    <h3>حجم الشاشة:</h3>
                    <div id="screenInfo">جاري التحميل...</div>
                </div>
            </div>

            <div class="debug-section">
                <h2>🚨 سجل الأخطاء</h2>
                <div class="debug-item">
                    <div id="errorLog">لا توجد أخطاء</div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 موقع إسلامي. جميع الحقوق محفوظة.</p>
        </div>
    </footer>

    <script src="../data/data.js"></script>
    <script src="../js/script.js"></script>
    <script>
        // Debug functionality
        function logError(message) {
            const errorLog = document.getElementById('errorLog');
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            errorLog.innerHTML += `<div class="status-error">[${timestamp}] ${message}</div>`;
        }

        function logSuccess(message) {
            const errorLog = document.getElementById('errorLog');
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            errorLog.innerHTML += `<div class="status-success">[${timestamp}] ${message}</div>`;
        }

        function logWarning(message) {
            const errorLog = document.getElementById('errorLog');
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            errorLog.innerHTML += `<div class="status-warning">[${timestamp}] ${message}</div>`;
        }

        // Test data loading
        function testDataStatus() {
            const dataStatus = document.getElementById('dataStatus');
            
            try {
                if (typeof islamicData !== 'undefined') {
                    const sectionsCount = islamicData.sections ? islamicData.sections.length : 0;
                    dataStatus.innerHTML = `
                        <div class="status-success">✅ البيانات محملة بنجاح</div>
                        <div>عدد الأقسام: ${sectionsCount}</div>
                        <div>الأقسام المتاحة: ${islamicData.sections ? islamicData.sections.map(s => s.title).join(', ') : 'لا توجد'}</div>
                    `;
                    logSuccess('تم تحميل البيانات بنجاح');
                } else {
                    dataStatus.innerHTML = '<div class="status-error">❌ فشل في تحميل البيانات</div>';
                    logError('فشل في تحميل البيانات');
                }
            } catch (error) {
                dataStatus.innerHTML = `<div class="status-error">❌ خطأ في البيانات: ${error.message}</div>`;
                logError(`خطأ في البيانات: ${error.message}`);
            }
        }

        // Test navigation
        function testNavigation(type) {
            try {
                switch(type) {
                    case 'home':
                        window.location.href = '../home.html';
                        break;
                    case 'section':
                        window.location.href = 'section.html?sectionId=aqeedah';
                        break;
                    case 'topic':
                        window.location.href = 'topic.html?sectionId=aqeedah&topicId=tawheed';
                        break;
                    case 'contact':
                        window.location.href = 'contact.html';
                        break;
                }
                logSuccess(`تم اختبار التنقل إلى: ${type}`);
            } catch (error) {
                logError(`خطأ في التنقل إلى ${type}: ${error.message}`);
            }
        }

        // Test website functions
        function testWebsiteFunctions() {
            try {
                if (window.website) {
                    const sections = window.website.getAllSections();
                    logSuccess(`تم اختبار وظائف الموقع. عدد الأقسام: ${sections.length}`);
                } else {
                    logError('كائن الموقع غير متاح');
                }
            } catch (error) {
                logError(`خطأ في اختبار وظائف الموقع: ${error.message}`);
            }
        }

        // Test data access
        function testDataAccess() {
            try {
                if (window.IslamicWebsiteUtils) {
                    const sections = window.IslamicWebsiteUtils.getAllSections();
                    logSuccess(`تم الوصول للبيانات. عدد الأقسام: ${sections.length}`);
                } else {
                    logError('وظائف الموقع غير متاحة');
                }
            } catch (error) {
                logError(`خطأ في الوصول للبيانات: ${error.message}`);
            }
        }

        // Test search
        function testSearch() {
            try {
                if (window.IslamicWebsiteUtils) {
                    const results = window.IslamicWebsiteUtils.searchSections('التوحيد');
                    logSuccess(`تم اختبار البحث. النتائج: ${results.length}`);
                } else {
                    logError('وظيفة البحث غير متاحة');
                }
            } catch (error) {
                logError(`خطأ في البحث: ${error.message}`);
            }
        }

        // Test screen responsiveness
        function testScreenInfo() {
            const screenInfo = document.getElementById('screenInfo');
            screenInfo.innerHTML = `
                <div>عرض الشاشة: ${window.innerWidth}px</div>
                <div>ارتفاع الشاشة: ${window.innerHeight}px</div>
                <div>نسبة العرض إلى الارتفاع: ${(window.innerWidth / window.innerHeight).toFixed(2)}</div>
                <div>نوع الجهاز: ${window.innerWidth < 768 ? 'جوال' : 'حاسوب'}</div>
            `;
        }

        // Initialize debug page
        document.addEventListener('DOMContentLoaded', () => {
            testDataStatus();
            testScreenInfo();
            
            // Test for common issues
            setTimeout(() => {
                if (!window.website) {
                    logError('كائن الموقع غير مُنشأ');
                }
                
                if (!window.IslamicWebsiteUtils) {
                    logError('وظائف الموقع غير متاحة');
                }
                
                if (typeof islamicData === 'undefined') {
                    logError('البيانات غير محملة');
                }
            }, 1000);
        });

        // Monitor for errors
        window.addEventListener('error', (event) => {
            logError(`خطأ في JavaScript: ${event.message}`);
        });

        // Monitor for unhandled promise rejections
        window.addEventListener('unhandledrejection', (event) => {
            logError(`خطأ في Promise: ${event.reason}`);
        });
    </script>
</body>
</html> 